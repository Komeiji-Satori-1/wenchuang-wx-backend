{% load static %}
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>订单详情 - {{ order.id }}</title>
  <link rel="stylesheet" href="{% static 'plugins/bootstrap-5.3.8-dist/css/bootstrap.css' %}">
  <script src="{% static 'js/jquery-3.7.1.js' %}"></script>
  <script src="{% static 'plugins/bootstrap-5.3.8-dist/js/bootstrap.js' %}"></script>
</head>
<body>
<div class="container mt-5">
  <h2>订单详情 - 订单号: {{ order.id }}</h2>
  <div class="mb-3">
    <p>用户: <strong>{{ order.user.nickname }}</strong></p>
    <p>状态: 
      {% if order.status == 'pending' %}
        <span class="badge bg-warning text-dark">{{ order.get_status_display }}</span>
      {% elif order.status == 'paid' %}
        <span class="badge bg-primary">{{ order.get_status_display }}</span>
      {% elif order.status == 'shipped' %}
        <span class="badge bg-info text-dark">{{ order.get_status_display }}</span>
      {% elif order.status == 'completed' %}
        <span class="badge bg-success">{{ order.get_status_display }}</span>
      {% else %}
        <span class="badge bg-secondary">{{ order.get_status_display }}</span>
      {% endif %}
    </p>
    <p>总金额: <strong>¥{{ order.total_amount }}</strong></p>
    <p>下单时间: {{ order.created_at|date:"Y-m-d H:i" }}</p>
  </div>

  <h3>订单明细</h3>
  <table class="table table-striped table-bordered align-middle">
    <thead class="table-dark">
      <tr>
        <th>产品</th>
        <th>数量</th>
        <th>单价</th>
        <th>小计</th>
      </tr>
    </thead>
    <tbody>
      {% for item in items %}
      <tr>
        <td>{{ item.product.name }}</td>
        <td>{{ item.quantity }}</td>
        <td>¥{{ item.price }}</td>
        <td>¥{{ item.subtotal|floatformat:2 }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <h3>支付信息</h3>
  <ul class="list-group">
    {% for pay in payments %}
      <li class="list-group-item d-flex justify-content-between align-items-center">
        {{ pay.get_payment_method_display }} - {{ pay.status }} - ¥{{ pay.amount }}
        {% if pay.transaction_id %}
        <span class="badge bg-secondary">交易号: {{ pay.transaction_id }}</span>
        {% endif %}
      </li>
    {% endfor %}
  </ul>

  <div class="mt-3">
    <a href="{% url 'orders:order_list' %}" class="btn btn-secondary">返回订单列表</a>
  </div>
</div>
</body>
</html>

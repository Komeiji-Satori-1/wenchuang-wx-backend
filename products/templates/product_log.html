{% load static %}
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ“ä½œæ—¥å¿—</title>

  <!-- Bootstrap CSS -->
  <link href="{% static 'plugins/bootstrap-5.3.8-dist/css/bootstrap.css' %}" rel="stylesheet">
  <!-- DataTables CSS -->
  <link rel="stylesheet" href="{% static 'plugins/DataTable/css/dataTables.bootstrap5.min.css' %}">
</head>
<body>
<div class="container mt-5">
  <h2 class="mb-4">ğŸ“œ äº§å“æ“ä½œæ—¥å¿—</h2>
  <a href="/products/" class="btn btn-info">è¿”å›</a>
  <table id="logTable" class="table table-striped table-bordered">
    <thead class="table-dark">
      <tr>

        <th>äº§å“</th>
        <th>æ“ä½œç±»å‹</th>
        <th>ä¿®æ”¹å‰åç§°</th>
        <th>ä¿®æ”¹å‰ä»·æ ¼</th>
        <th>ä¿®æ”¹å‰åº“å­˜</th>
        <th>ä¿®æ”¹å</th>
        <th>å˜åŠ¨æ•°é‡</th>
        <th>æ“ä½œäºº</th>
        <th>æ“ä½œæ—¶é—´</th>
      </tr>
    </thead>
    <tbody>
      {% for entry in logs %}
      <tr>

        <td>{{ entry.product.name }}</td>
        <td>
          {% if entry.action == "('update',)" %}
            <span class="badge bg-primary">ä¿®æ”¹</span>
          {% elif entry.action == "('stock_in',)" %}
            <span class="badge bg-success">å…¥åº“</span>
          {% elif entry.action == "('stock_out',)" %}
            <span class="badge bg-danger">å‡ºåº“</span>
          {% elif entry.action == "('create',)" %}
            <span class="badge bg-secondary">æ·»åŠ äº§å“</span>
          {% else %}
              <span class="badge bg-dark">åˆ é™¤äº§å“</span>
          {% endif %}
        </td>
        <td>{{ entry.old_value.name }}</td>
        <td>{{ entry.old_value.price }}</td>
        <td>{{ entry.old_value.stock }}</td>

        <td>{{ entry.new_value }}</td>
        <td>
          {% if entry.change_amount > 0 %}
            <span class="text-success">+{{ entry.change_amount }}</span>
          {% elif entry.change_amount < 0 %}
            <span class="text-danger">{{ entry.change_amount }}</span>
          {% else %}
            {{ entry.change_amount }}
          {% endif %}
        </td>
        <td>{{ entry.admin.username }}</td>
        <td>{{ entry.created_at|date:"Y-m-d H:i" }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<!-- jQuery -->
<script src="{% static 'js/jquery-3.7.1.js' %}"></script>
<!-- DataTables JS -->
<script src="{% static 'js/jquery.dataTables.min.js' %}"></script>
<script src="{% static 'plugins/DataTable/js/dataTables.bootstrap5.min.js' %}"></script>
<!-- Bootstrap JS -->
<script src="{% static 'plugins/bootstrap-5.3.8-dist/js/bootstrap.js' %}"></script>

<script>
$(document).ready(function () {
  $('#logTable').DataTable({
    "pageLength": 10,
    "lengthMenu": [10, 20, 50],
    "order": [[7, "desc"]], // é»˜è®¤æŒ‰æ—¶é—´å€’åº
    "language": {
      "search": "ğŸ” æœç´¢æ—¥å¿—:",
      "lengthMenu": "æ¯é¡µæ˜¾ç¤º _MENU_ æ¡",
      "info": "ç¬¬ _START_ åˆ° _END_ æ¡ï¼Œå…± _TOTAL_ æ¡",
      "paginate": {
        "first": "é¦–é¡µ",
        "last": "æœ«é¡µ",
        "next": "ä¸‹ä¸€é¡µ",
        "previous": "ä¸Šä¸€é¡µ"
      }
    }
  });
});
</script>
</body>
</html>
